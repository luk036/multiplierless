<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplierless FIR Filter Design: A Comprehensive Analysis</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background-color: #f9f9f9;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #555;
            margin-top: 30px;
        }
        h4 {
            color: #666;
            margin-top: 25px;
        }
        p {
            margin-bottom: 15px;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
        }
        li {
            margin-bottom: 8px;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
        }
        pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        blockquote {
            border-left: 4px solid #3498db;
            padding-left: 20px;
            margin: 20px 0;
            color: #666;
            font-style: italic;
        }
        .math {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 15px 0;
            text-align: center;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            margin: 20px 0;
            border: 1px solid #ddd;
        }
        .mermaid {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }
        .emoji {
            font-size: 1.2em;
        }
        .section-number {
            color: #3498db;
            font-weight: bold;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">üéØ</span> Multiplierless FIR Filter Design: A Comprehensive Analysis <span class="emoji">üéõ</span></h1>

        <h2><span class="emoji">üìã</span> Introduction</h2>

        <p>In the realm of digital signal processing, FIR (Finite Impulse Response) filters play a crucial role in shaping signal characteristics. However, traditional FIR filters often require expensive multiplication operations, which can be computationally expensive and hardware-intensive. The <strong>multiplierless</strong> project presents an innovative solution to this challenge by implementing FIR filters that avoid multiplication operations entirely through the use of Canonical Signed Digit (CSD) representation and advanced optimization techniques.</p>

        <p>This essay provides a comprehensive analysis of the multiplierless project, exploring its mathematical foundations, algorithmic implementations, and practical applications. We'll delve into the spectral factorization approach, the CSD representation system, oracle-based optimization, and the ellipsoid method for convex optimization. The project represents a sophisticated approach to filter design that balances mathematical rigor with practical hardware efficiency.</p>

        <h2><span class="emoji">üéØ</span> Mathematical Foundations <span class="emoji">üìê</span></h2>

        <h3><span class="emoji">üìä</span> Spectral Factorization Theory</h3>

        <p>At the heart of the multiplierless project lies the <strong>spectral factorization</strong> problem. Given an autocorrelation sequence r[k], the goal is to find a minimum-phase impulse response h[k] such that:</p>

        <div class="math">R(z) = ‚àë<sub>k=-n</sub><sup>n</sup> r[k] z<sup>-k</sup> = |H(e<sup>jœâ</sup>)|<sup>2</sup></div>

        <p>The <strong>Kolmogorov 1939</strong> approach implemented in <code>spectral_fact.py</code> follows these mathematical steps:</p>

        <ol>
            <li><strong>Oversampling</strong>: The autocorrelation sequence is oversampled by a factor (typically 100x) to improve numerical stability</li>
            <li><strong>FFT Transformation</strong>: Convert the oversampled sequence to frequency domain via Fast Fourier Transform</li>
            <li><strong>Logarithm and Hilbert Transform</strong>: Apply logarithm and Hilbert transform to separate magnitude and phase components</li>
            <li><strong>Inverse FFT</strong>: Convert back to time domain to obtain the minimum-phase impulse response</li>
        </ol>

        <p>The mathematical formulation can be expressed as:</p>

        <div class="math">h[k] = F<sup>-1</sup>{‚àë<sub>i=0</sub><sup>M-1</sup> log(R[i]) e<sup>j2œÄki/M</sup>}</div>

        <p>where M is the oversampling factor and R[i] represents the magnitude spectrum.</p>

        <h3><span class="emoji">üî¢</span> Canonical Signed Digit (CSD) Representation</h3>

        <p>The <strong>CSD (Canonical Signed Digit)</strong> system is a signed-digit number representation that uses digits from the set {-1, 0, +1}. This representation is particularly valuable for multiplierless implementation because:</p>

        <ul>
            <li><strong>Hardware Efficiency</strong>: CSD representation allows addition and subtraction operations to replace multiplication</li>
            <li><strong>Sparsity</strong>: CSD representations typically contain fewer non-zero digits than binary representations</li>
            <li><strong>Deterministic Conversion</strong>: The conversion process is completely deterministic and reversible</li>
        </ul>

        <p>The CSD conversion process implemented in <code>csd.tpy</code> follows this algorithm:</p>

        <div class="mermaid">
            flowchart TD
                A[Decimal Number] --> B[Find Power of 2 Closest to Num] --> C["Subtract & Mark (+, -, or 0)"]
                C --> D[Repeat for Remaining Value] --> E[CSD String]
                D --> E["Verification (CSD to Decimal)"] --> F[Final CSD String]
        </div>

        <p>The conversion function <code>to_csd(num, places=0, nnz=4)</code> allows specification of the number of non-zero digits (<code>nnz</code>) and fractional places.</p>

        <h3><span class="emoji">üîµ</span> Ellipsoid Method for Convex Optimization</h3>

        <p>The <strong>ellipsoid method</strong> is used for solving convex optimization problems. For the multiplierless filter design, it efficiently finds the optimal filter coefficients while satisfying multiple constraints:</p>

        <div class="math">min<sub>x</sub> subject to g<sub>i</sub>(x) ‚â§ 0, i = 1, 2, ‚Ä¶, m</div>

        <p>The optimization oracle system implemented in <code>lowpass_oracle.py</code> follows a specific decision process:</p>

        <div class="mermaid">
            flowchart TD
                A["Filter Coefficients (x)"] --> B{Non-negative Real Constraint Violated?}
                B -->|Yes| C["Passband Constraints (Ap @ x)"]
                C -->|No| D["Stopband Constraint (As @ x)"]
                D -->|Yes| E["Other Frequency Constraints"]
                E -->|No| F["Objective Function (Update Spsq)"]
                F -->|Yes| G[Updated Filter Design]
        </div>

        <h2><span class="emoji">üîç</span> Algorithm Implementation <span class="emoji">üîß</span></h2>

        <h3>Core Components</h3>

        <h4>Spectral Factorization (<code>spectral_fact.py</code>)</h4>

        <p>The spectral factorization implementation in <code>src/multiplierless/spectral_fact.py</code> uses the Kolmogorov 1939 approach:</p>

        <pre><code>def spectral_fact(r: np.ndarray) -> np.ndarray:
    """Computes the minimum-phase impulse response which satisfies a given auto-correlation."""
    n = len(r)
    mult_factor = 100  # oversampling factor
    m = mult_factor * n
    # ... complex mathematical operations including FFT and Hilbert transforms</code></pre>

        <h4>Lowpass Oracle (<code>lowpass_oracle.py</code>)</h4>

        <p>The lowpass oracle implements constraint checking in a specific order:</p>

        <ol>
            <li><strong>Non-negative real constraint</strong></li>
            <li><strong>Passband constraints</strong></li>
            <li><strong>Stopband constraint</strong></li>
            <li><strong>Other frequency constraints</strong></li>
            <li><strong>Objective function</strong></li>
        </ol>

        <h4>CSD Integration (<code>lowpass_oracle_q.py</code>)</h4>

        <p>The <code>LowpassOracleQ</code> class integrates CSD conversion with the optimization oracle:</p>

        <pre><code>def assess_optim_q(r, Spsq, retry):
    """Assess and optimize filter coefficients with CSD constraints."""
    # Convert to CSD format
    h_csd = to_csdnnz(h, nnz=4)
    # Apply spectral factorization
    h = spectral_fact(h_csd)
    # Assess optimization
    g, f = oracle.assess_optim(h, Spsq)
    return g, f, None</code></pre>

        <h3>Optimization Process Flow</h3>

        <p>The overall optimization process can be visualized as:</p>

        <div class="mermaid">
            graph TD
                A[Initial Filter Design] --> B[Spectral Factorization]
                B --> C[CSD Conversion]
                C --> D[Oracle Assessment]
                D --> E[Constraint Violation?]
                E -->|Yes| F[Update Constraints]
                E -->|No| G[Converged?]
                F -->|Yes| H[Final Filter Design]
                G -->|No| I[Iterate]
                I --> J[Update Design Parameters]
                J --> D
        </div>

        <h2><span class="emoji">üìä</span> Practical Applications and Examples <span class="emoji">üéØ</span></h2>

        <h3><span class="emoji">üíª</span> Hardware Implementation Benefits</h3>

        <p>The primary advantage of multiplierless filters is their suitability for hardware implementation:</p>

        <ul>
            <li><strong>Reduced Complexity</strong>: Eliminates expensive multiplication operations</li>
            <li><strong>Lower Power Consumption</strong>: Multiplication operations are power-intensive in hardware</li>
            <li><strong>Faster Execution</strong>: Addition and subtraction are computationally simpler than multiplication</li>
            <li><strong>Deterministic Timing</strong>: Predictable execution time independent of coefficient values</li>
        </ul>

        <h3><span class="emoji">üìä</span> Filter Performance Characteristics</h3>

        <p>The SVG diagrams in <code>figs/</code> illustrate the performance characteristics:</p>

        <ol>
            <li><strong>FIR-continues.svg</strong>: Shows frequency response plots comparing traditional vs. multiplierless implementations</li>
        </ol>

        <p><img src="figs/FIR-continues.svg" alt="FIR Frequency Response"></p>

        <ol start="2">
            <li><strong>multiplierless_48_3.svg</strong>: Compares different filter configurations</li>
        </ol>

        <p><img src="figs/multiplierless_48_3.svg" alt="Multiplierless Filter Configuration"></p>

        <ol start="3">
            <li><strong>multiplierless_48_4.svg</strong>: Displays group delay characteristics</li>
        </ol>

        <p><img src="figs/multiplierless_48_4.svg" alt="Group Delay Characteristics"></p>

        <h3><span class="emoji">üìè</span> Design Constraints</h3>

        <p>The multiplierless approach handles multiple filter design constraints:</p>

        <ul>
            <li><strong>Passband ripple</strong>: Ensure minimal distortion in the passband region</li>
            <li><strong>Stopband attenuation</strong>: Achieve required stopband attenuation without multiplication</li>
            <li><strong>Non-negative real</strong>: Maintain physical realizability</li>
            <li><strong>CSD digit limits</strong>: Control coefficient sparsity through <code>nnz</code> parameter</li>
        </ul>

        <h2><span class="emoji">üßÆ</span> Advanced Features <span class="emoji">üöÄ</span></h2>

        <h3><span class="emoji">üîÄ</span> Ellipsoid Method with Parallel Cuts</h3>

        <p>The ellipsoid method implementation supports <strong>parallel cuts</strong>, which significantly accelerates convergence:</p>

        <pre><code># Parallel cuts allow multiple constraint violations to be addressed simultaneously
return (g, f), None  # g: gradient, f: function value, Spsq: updated best-so-far Sp^2</code></pre>

        <h3><span class="emoji">üîß</span> Adaptive CSD Conversion</h3>

        <p>The <code>to_csdnnz()</code> function allows adaptive sparsity control:</p>

        <pre><code>def to_csdnnz(num, nnz=4, debug=False):
    """Convert to CSD format with limited non-zero digits."""
    # Intelligent digit placement algorithm
    # Returns CSD string with specified number of non-zero digits</code></pre>

        <h3><span class="emoji">üéØ</span> Multi-Objective Optimization</h3>

        <p>The system supports multiple objective functions:</p>

        <ul>
            <li><strong>Minimize stopband energy</strong>: min ‚àë<sub>kœâ‚ààŒ©<sub>s</sub></sub> |H(e<sup>jœâ</sup>)|<sup>2</sup></li>
            <li><strong>Minimize passband ripple</strong>: max<sub>kœâ‚ààŒ©<sub>p</sub></sub> |1 - |H(e<sup>jœâ</sup>)|<sup>2</sup> - 1|</li>
            <li><strong>Maximize stopband attenuation</strong>: max ‚àë<sub>kœâ‚ààŒ©<sub>s</sub></sub> |H(e<sup>jœâ</sup>)|<sup>2</sup></li>
        </ul>

        <h2><span class="emoji">üî¨</span> Future Enhancements <span class="emoji">üöÄ</span></h2>

        <p>The multiplierless project provides a solid foundation for future research and development:</p>

        <ol>
            <li><strong>Higher Order Filters</strong>: Extend to longer impulse responses</li>
            <li><strong>Adaptive Algorithms</strong>: Implement adaptive step sizes and convergence criteria</li>
            <li><strong>Hardware Generation</strong>: Generate synthesizable hardware descriptions</li>
            <li><strong>Multi-band Extensions</strong>: Support multi-band filter design</li>
            <li><strong>Real-time Implementation</strong>: Develop real-time adaptive filtering capabilities</li>
        </ol>

        <h2><span class="emoji">üìö</span> Conclusion <span class="emoji">üìö</span></h2>

        <p>The multiplierless project represents a sophisticated approach to FIR filter design that successfully balances mathematical rigor with hardware efficiency. By combining spectral factorization, CSD representation, and oracle-based optimization with the ellipsoid method, it provides a complete solution for designing multiplierless digital filters.</p>

        <p>The mathematical foundation is sound, based on Kolmogorov's 1939 spectral factorization approach. The CSD representation enables hardware-friendly implementations, while the oracle system ensures that all design constraints are systematically satisfied. The ellipsoid method provides efficient convergence to optimal solutions.</p>

        <p>This approach demonstrates how advanced mathematical algorithms can be adapted for practical hardware constraints without sacrificing theoretical correctness. The multiplierless project stands as a testament to the ingenuity of its developers in bridging the gap between theoretical signal processing theory and practical hardware implementation.</p>

        <h2><span class="emoji">üìö</span> References <span class="emoji">üìö</span></h2>

        <ol>
            <li>Kolmogorov, A. (1939). "On the determination of the minimum-phase sequence from the autocorrelation coefficients."</li>
            <li>Kolmogorov, A. (1939). "The extrapolation of the minimum-phase sequence from the autocorrelation coefficients."</li>
            <li>Oppenheim, A. V., & Schafer, R. W. (1989). "Discrete-Time Signal Processing."</li>
            <li>Oppenheim, A. V. & Schafer, R. W. (2009). "Discrete-Time Signal Processing."</li>
            <li>Boyd, S. & Vandenbergheghe, L. (2004). "Convex Optimization."</li>
        </ol>
    </div>
</body>
</html>